<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="description" content="Un jeu où trouver un nombre entre un MIN et un MAX">
    <title>Find the number</title>
    <link rel="stylesheet" href="css/stylev2.css">
</head>

<body>
    <main class="main">
        <!-- <a href="https://css-tricks.com/auto-growing-inputs-textareas/#aa-non-input-elements-expand-naturally"></a> -->
        <h1 title="Devine le nombre entre MIN et MAX">Devine le nombre </br> entre
            <span title="MIN / Nombre minimum possible" id="min" role="textbox" contenteditable inputmode="numeric"
                pattern="[0-9]*">0</span>
            and
            <span title="MAX / Nombre maximum possible" id="max" role="textbox" contenteditable inputmode="numeric"
                pattern="[0-9]*">1000</span>
        </h1>
        <div class="table-jeu">
            <div title="Information sur votre supposition" class="indicateurs">
                <div title="Gardez verifs au plus bas !">Verifs : <span id="nbVerif"></span></div>
                <div id="output" style="display:none;">Devine le nombre :</div>
                <div id="indicator_win" style="display:none;">Victoire !</div>
                <div id="indicator_more" style="display:none;">Nombre > <span>value</span></div>
                <div id="indicator_less" style="display:none;">Nombre < <span>value</span></div>
                <div id="indicator_empty" style="display:block;">Devine le nombre</div>
            </div>
            <!-- <a href="https://stackoverflow.blog/2022/12/26/why-the-Number - input-is-the-worst-input/#:~:text=The%20Gov%2EUK%20article%20mentions%20a%20possible%20solution%3A%20Using%20%3Cinput%20type%3D%22text%22%20inputmode%3D%22numeric%22%20pattern%3D%22%5B0%2D9%5D%2A%22%3E%20is%20a%20nice%20option%20for%20integers%2C%20but%20it%20won%E2%80%99t%20work%20for%20floating%20point%20decimal%20numbers">https://stackoverflow.blog/2022/12/26/why-the-Number - input-is-the-worst-input/</a> -->
            <input autofocus="false" class="input" id="input" type="text" inputmode="numeric" pattern="[0-9]*"
                placeholder="Entre un nombre" title="Entre un nombre ou utilise les boutons">
            </input>
            <div class="plateau-boutons">
                <div class="twoButtons">
                    <button class="button" title="Nombre / 2" id="divide" onclick="operation('/',2)">/ 2 </button>
                    <button class="button" title="Nombre x 1.5" id="multiply" onclick="operation('*',1.5)">x
                        1.5</button>
                </div>
                <div class="twoButtons">
                    <button class="button" title="Nombre - MAX/200*15" id="button1" onclick="operation('-',75)">-
                        75</button>
                    <button class="button" title="Nombre + MAX/200*25" id="button2"
                        onclick="operation('+',125)">+125</button>
                </div>
                <div class="twoButtons">
                    <button class="button" title="Nombre - MAX/200*5" id="button3" onclick="operation('-',25)">-
                        25</button>
                    <button class="button" title="Nombre + MAX/200*10" id="button4" onclick="operation('+',50)">+
                        50</button>
                </div>
                <div class="twoButtons">
                    <button class="button" title="Nombre - MAX/200" id="button5" onclick="operation('-',5)">- 5</button>
                    <button class="button" title="Nombre + MAX/200*2" id="button6" onclick="operation('+',10)">+
                        10</button>
                </div>
                <div class="twoButtons">
                    <button class="button" title="Nombre - 1" id="button7" onclick="operation('-',1)">- 1</button>
                    <button class="button" title="Nombre + 1" id="button8" onclick="operation('+',1)">+ 1</button>
                </div>
                <div class="twoButtons">
                    <button class="button" title="Appuie sur [n] pour générer un nouveau nombre à trouver"
                        id="reload">Nouvelle partie</button>
                    <button class="button" title="Appuie sur [Enter] pour vérifier ta supposition actuelle"
                        onclick="verifNb()">Entrer</button>
                </div>
            </div>
        </div>
        <div class="version-source">
            <p id="wins">Victoires : <span role="textbox" contenteditable inputmode="numeric" pattern="[0-9]*">0</span>
            </p>
            <p>fr | <a href="index.html">en</a></p>
            <p> <span title="Version actuelle de la page" id="version">V3fr_2025-12-12_11:55 IE</span>
                <a href="https://github.com/thomaslinux/GuessTheRandomNumberJavascript/"> source</a>
            </p>
        </div>
        <script>
            let MIN = 0;
            let MAX = 1000;
            let nbToFind = 0;
            let nbVerif = 0;
            let wins = 0;
            const output = document.getElementById("output");
            const input = document.getElementById("input");
            const infoNbVerif = document.getElementById("nbVerif");
            const htmlMIN = document.getElementById("min");
            const htmlMAX = document.getElementById("max");
            const reload = document.getElementById("reload");
            reload.addEventListener('click', (e) => { init(); });
            // window.onload = init;
            init();

            function init() {
                wins = parseInt(localStorage.getItem("wins")) || 0;
                htmlMIN.innerText = MIN;
                htmlMAX.innerText = MAX;
                nbToFind = alea(MIN, MAX);
                nbVerif = -1;
                verif();
                input.value = MAX;
                verifNb();
                infoNbVerif.innerText = "0";
                document.querySelector("#wins span").innerText = wins;
            }

            input.addEventListener("input", verif)
            input.addEventListener("wheel", onWheel)
            function onWheel(e) {
                e.preventDefault();
                if (e.deltaY > 0) { // on scroll down
                    operation('-', MAX / 20);
                } else if (e.deltaY < 0) { // on scroll up
                    operation('+', MAX / 20);
                }
            }

            document.addEventListener('keydown', function (e) {
                verifKey(e);
            });
            function verifKey(e) {
                if (e.key === 'Enter') {
                    verifNb();
                }
                if (e.key === 'n' || e.key === ' ') {
                    init();
                }
                if (e.key === 'ArrowUp') { operation('+', MAX / 20); }
                //if (e.key === 'ArrowRight') {operation('+', MAX / 20);}
                if (e.key === 'ArrowDown') { operation('-', MAX / 20); }
                //if (e.key === 'ArrowLeft') {operation('-', MAX / 20);}

            }



            function operation(operator, number) {
                let value = parseInt(input.value) || 0;
                let result = 0;
                switch (operator) {
                    case '*': result = value * number; break;
                    case '+': result = value + number; break;
                    case '-': result = value - number; break;
                    case '/': value != 0 ? result = value / number : result = value; break;
                    default: result = value; break;
                }
                input.value = Math.floor(result);
                verifNb();
            }

            function verif() {
                input.value = input.value.replace(/\D+/g, ''); // force numbers
            }
            function verifNb() {

                // hide all elements first
                document.querySelector("#indicator_more").style.display = "none";
                document.querySelector("#indicator_less").style.display = "none";
                document.querySelector("#indicator_empty").style.display = "none";
                document.querySelector("#indicator_win").style.display = "none";

                // display the element to display
                if (input.value === '') {
                    // input.value = '0'
                    output.innerText = "Guess the number !"
                    document.querySelector("#indicator_empty").style.display = "block";
                } else if (nbToFind > input.value) {
                    output.innerText = "Number > " + input.value;
                    document.querySelector("#indicator_more").style.display = "block";
                    document.querySelector("#indicator_more span").innerText = input.value;
                    htmlMIN.innerText = input.value;
                } else if (nbToFind < input.value) {
                    output.innerText = "Number < " + input.value;
                    document.querySelector("#indicator_less").style.display = "block";
                    document.querySelector("#indicator_less span").innerText = input.value;
                    htmlMAX.innerText = input.value;
                } else {
                    output.innerText = "You win !"
                    document.querySelector("#indicator_win").style.display = "block";
                    htmlMIN.innerText = input.value;
                    htmlMAX.innerText = input.value;
                    wins = document.querySelector("#wins span").innerText;
                    wins++;
                    localStorage.setItem("wins", wins);
                    document.querySelector("#wins span").innerText = wins;
                }
                nbVerif++;
                infoNbVerif.innerText = nbVerif;
            }

            /**
             * @param {Number} MIN valeur minimum du nombre aléatoire (inclue)
             * @param {Number} MAX valeur maximum du nombre aléatoire (excluse)
             * @returns {Number} un entier aléatoire entre une valeur MIN (inclue) et une valeur MAX (exclue)
             */
            function alea(MIN, MAX) {
                return Math.floor(Math.random() * (MAX - MIN) + MIN);
            }
        </script>
    </main>
</body>

</html>